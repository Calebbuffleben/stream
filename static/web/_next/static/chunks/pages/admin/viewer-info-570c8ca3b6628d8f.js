(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6109],{92794:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/viewer-info",function(){return a(65874)}])},31112:function(e,t,a){"use strict";a.d(t,{k:function(){return c}});var n=a(85893),s=a(12642),r=a(67294),o=a(71218),i=a(23148),l=a(26495),u=a(56469);function d(e){let t={};return e.forEach(e=>{let a=new Date(e.time);t[(0,s.WU)(a,"H:mma")]=e.value}),t}i.kL.register(i.uw,i.WV,i.f$,i.od,i.jn,i.Dx,i.u,i.De);let c=e=>{let{data:t,title:a,color:s,unit:i,dataCollections:c,yFlipped:h,yLogarithmic:m,minYValue:w,yStepSize:f=0}=e,y=[],g=(0,r.useRef)(null);return t&&t.length>0&&y.push({id:a,label:a,backgroundColor:s,borderColor:s,borderWidth:3,data:d(t)}),c.forEach(e=>{y.push({id:e.name,label:e.name,data:d(e.data),backgroundColor:e.color,borderColor:e.color,borderWidth:3,pointStyle:e.pointStyle||"circle",radius:e.pointRadius||1})}),(0,n.jsxs)("div",{className:"line-chart-container",children:[(0,n.jsx)(l.x1,{ref:g,data:{datasets:y},options:{responsive:!0,clip:!1,scales:{y:{type:m?"logarithmic":"linear",reverse:h,min:w,ticks:{stepSize:f},title:{display:!0,text:i}}}},height:"70vh"}),(0,n.jsx)(u.Z,{size:"small",onClick:()=>{if(g.current){let e=document.createElement("a");e.download="chart.png",e.href=g.current.canvas.toDataURL(),e.click()}},type:"ghost",icon:(0,n.jsx)(o.Z,{}),className:"download-btn"})]})};c.defaultProps={dataCollections:[],data:[],title:"",yFlipped:!1,yLogarithmic:!1}},26826:function(e,t,a){"use strict";a.d(t,{m:function(){return m}});var n=a(85893),s=a(23657),r=a(92120),o=a(75543),i=a(3816);let{Text:l}=s.default,u={title:"",value:0,prefix:null,suffix:null,color:"",progress:!1,centered:!1,formatter:null},d=e=>{let{prefix:t,value:a,suffix:s,title:r}=e;return(0,n.jsxs)("div",{children:[t,(0,n.jsx)("div",{children:(0,n.jsx)(l,{type:"secondary",children:r})}),(0,n.jsx)("div",{children:(0,n.jsxs)(l,{type:"secondary",children:[a,s||"%"]})})]})},c=e=>{let{title:t,value:a,prefix:s,suffix:o,color:i}=e,l=a>90?"red":i,u=(0,n.jsx)(d,{prefix:s,value:a,suffix:o,title:t});return(0,n.jsx)(r.Z,{type:"dashboard",percent:a,width:120,strokeColor:{"0%":i,"90%":l},format:()=>u})};c.defaultProps=u;let h=e=>{let{title:t,value:a,prefix:s,formatter:r}=e;return(0,n.jsx)(o.Z,{title:t,value:a,prefix:s,formatter:r})};h.defaultProps=u;let m=e=>{let{progress:t,centered:a}=e,s=t?c:h;return(0,n.jsx)(i.default,{type:"inner",children:(0,n.jsx)("div",{style:a?{display:"flex",alignItems:"center",justifyContent:"center"}:{},children:(0,n.jsx)(s,{...e})})})};m.defaultProps=u},3064:function(e,t,a){"use strict";let n=a(39219);e.exports={translations:{en:n},defaultLang:"en",useBrowserDefault:!0,languageDataStore:"query"}},23061:function(e,t,a){"use strict";var n=a(67294),s=a(64773),r=a(98947);t.Z=function(){var e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=(0,n.useRef)({}),a=(0,s.Z)();return(0,n.useEffect)(function(){var n=r.ZP.subscribe(function(n){t.current=n,e&&a()});return function(){return r.ZP.unsubscribe(n)}},[]),t.current}},65874:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return N}});var n=a(85893),s=a(67294),r=a(23657),o=a(10227),i=a(78021),l=a(1461),u=a(93879),d=a(70449),c=a(16393),h=a(6916),m=a(32532);function w(e,t,a){var n,s,r;let{years:o=0,months:i=0,weeks:l=0,days:u=0,hours:d=0,minutes:w=0,seconds:f=0}=t,y=(n=i+12*o,s=(0,m.z)(e,-n,a),r=u+7*l,(0,h.E)(s,-r,a));return(0,c.L)((null==a?void 0:a.in)||e,+y-1e3*(f+60*(w+60*d)))}var f=a(46042),y=a(5152),g=a.n(y),v=a(37039),p=a(31112),b=a(26826),x=a(27043),S=a(61913),k=a(74040);let L=e=>{let{data:t}=e;return(0,n.jsx)(x.Z,{pagination:{hideOnSinglePage:!0},className:"table-container",columns:[{title:"User Agent",dataIndex:"userAgent",key:"userAgent",render:e=>(0,k.AB)(e)},{title:"Location",dataIndex:"geo",key:"geo",render:e=>e?"".concat(e.regionName,", ").concat(e.countryCode):"-"},{title:"Watch Time",dataIndex:"firstSeen",key:"firstSeen",defaultSortOrder:"ascend",render:e=>(0,S.Q)(new Date(e)),sorter:(e,t)=>new Date(e.firstSeen).getTime()-new Date(t.firstSeen).getTime(),sortDirections:["descend","ascend"]}],dataSource:t,size:"small",rowKey:"id"})};var I=a(4481),j=a(11992),C=a(25889);let O=g()(()=>Promise.all([a.e(3247),a.e(5746)]).then(a.t.bind(a,75746,23)),{loadableGenerated:{webpack:()=>[75746]},ssr:!1}),D=g()(()=>Promise.all([a.e(3247),a.e(6681)]).then(a.t.bind(a,96681,23)),{loadableGenerated:{webpack:()=>[96681]},ssr:!1});function N(){let e;let t=(0,s.useContext)(I.a),{t:a}=(0,v.$G)(),{online:c,broadcaster:h,viewerCount:m,overallPeakViewerCount:y,sessionPeakViewerCount:g}=t||{};h&&h.time&&(e=new Date(h.time));let x=[{title:a("Current stream"),start:e},{title:a("Last 12 hours"),start:w(new Date,{hours:12})},{title:a("Last 24 hours"),start:w(new Date,{hours:24})},{title:a("Last 7 days"),start:w(new Date,{days:7})},{title:a("Last 30 days"),start:w(new Date,{days:30})},{title:a("Last 3 months"),start:w(new Date,{months:3})},{title:a("Last 6 months"),start:w(new Date,{months:6})}],[S,k]=(0,s.useState)(!0),[C,N]=(0,s.useState)([]),[P,E]=(0,s.useState)([]),[M,T]=(0,s.useState)(x[1]),V=async()=>{try{var e;let t="".concat(j.iV,"?windowStart=").concat((e=M.start,Math.trunc(+(0,f.Q)(e)/1e3))),a=await (0,j.rQ)(t);N(a),k(!1)}catch(e){console.log("==== error",e)}try{let e=await (0,j.rQ)(j.a_);E(e)}catch(e){console.log("==== error",e)}};(0,s.useEffect)(()=>{let e=null;return(V(),c)?(e=setInterval(V,6e4),()=>{clearInterval(e)}):()=>[]},[c,M]);let F=e=>{let{key:t}=e;T(x[t])},H=c&&e?0:1,Z=x.slice(H).map((e,t)=>({key:t+H,label:e.title,onClick:F}));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.default.Title,{children:a("Viewer Info")}),(0,n.jsx)("br",{}),(0,n.jsxs)(o.Z,{gutter:[16,16],justify:"space-around",children:[c&&(0,n.jsx)(i.Z,{span:8,md:8,children:(0,n.jsx)(b.m,{title:a("Current viewers"),value:m.toString(),prefix:(0,n.jsx)(D,{})})}),(0,n.jsx)(i.Z,{md:c?8:12,children:(0,n.jsx)(b.m,{title:a(c?"Max viewers this stream":"Max viewers last stream"),value:g.toString(),prefix:(0,n.jsx)(D,{})})}),(0,n.jsx)(i.Z,{md:c?8:12,children:(0,n.jsx)(b.m,{title:a("max viewers"),value:y.toString(),prefix:(0,n.jsx)(D,{})})})]}),!C.length&&(0,n.jsx)(l.Z,{style:{marginTop:"10px"},banner:!0,message:a("Please wait"),description:a("No viewer data has been collected yet."),type:"info"}),(0,n.jsxs)(u.Z,{spinning:!C.length||S,children:[C.length>0&&(0,n.jsx)(p.k,{title:a("Viewers"),data:C,color:"#2087E2",unit:"viewers",minYValue:0,yStepSize:1}),(0,n.jsx)(d.Z,{menu:{items:Z},trigger:["click"],children:(0,n.jsxs)("button",{type:"button",style:{position:"absolute",top:"5px",right:"35px",background:"transparent",border:"unset"},children:[M.title," ",(0,n.jsx)(O,{})]})}),(0,n.jsx)(L,{data:P})]})]})}N.getLayout=function(e){return(0,n.jsx)(C.l,{page:e})}},6916:function(e,t,a){"use strict";a.d(t,{E:function(){return r}});var n=a(16393),s=a(46042);function r(e,t,a){let r=(0,s.Q)(e,null==a?void 0:a.in);return isNaN(t)?(0,n.L)((null==a?void 0:a.in)||e,NaN):(t&&r.setDate(r.getDate()+t),r)}},32532:function(e,t,a){"use strict";a.d(t,{z:function(){return r}});var n=a(16393),s=a(46042);function r(e,t,a){let r=(0,s.Q)(e,null==a?void 0:a.in);if(isNaN(t))return(0,n.L)((null==a?void 0:a.in)||e,NaN);if(!t)return r;let o=r.getDate(),i=(0,n.L)((null==a?void 0:a.in)||e,r.getTime());return(i.setMonth(r.getMonth()+t+1,0),o>=i.getDate())?i:(r.setFullYear(i.getFullYear(),i.getMonth(),o),r)}},39219:function(e){"use strict";e.exports=JSON.parse('{"Notify":"Notify","Level":"Level","Info":"Info","Warning":"Warning","Error":"Error","Timestamp":"Timestamp","Message":"Message","Logs":"Logs","Link":"Link","No news":"No news.","News & Updates from Owncast":"News & Updates from Owncast","Use your broadcasting software":"Use your broadcasting software","Learn how to point your existing software to your new server and start streaming your content":"Learn how to point your existing software to your new server and start streaming your content.","View":"View","Overridden via command line":"Overridden via command line.","Embed your video onto other sites":"Embed your video onto other sites","Learn how you can add your Owncast stream to other sites you control":"Learn how you can add your Owncast stream to other sites you control.","Chat is disabled":"Chat is disabled","Chat will continue to be disabled until you begin a live stream":"Chat will continue to be disabled until you begin a live stream.","Find an audience on the Owncast Directory":"Find an audience on the Owncast Directory","List yourself in the Owncast Directory and show off your stream":{" Enable it in":"List yourself in the Owncast Directory and show off your stream. Enable it in"},"settings":"settings.","Add your Owncast instance to the Fediverse":"Add your Owncast instance to the Fediverse","Enable Owncast social features":"Enable Owncast social features","to have your instance join the Fediverse, allowing people to follow, share and engage with your live stream":"to have your instance join the Fediverse, allowing people to follow, share and engage with your live stream.","No stream is active":"No stream is active","You should start one":"You should start one.","Healthy Stream":"Healthy Stream","Yes":"Yes","No":"No","Playback Health":"Playback Health","Stream health represents":"Stream health represents","of all known players":{" Other player status is unknown":"of all known players. Other player status is unknown."},"TROUBLESHOOT":"TROUBLESHOOT","Powered by Owncast":"Powered by Owncast","Documentation":"Documentation","Contribute":"Contribute","Source":"Source","Skip to player":"Skip to player","Skip to offline message":"Skip to offline message","Skip to page content":"Skip to page content","Skip to footer":"Skip to footer","Chat will be available when the stream is live":"Chat will be available when the stream is live.","Chat is offline":"Chat is offline","Stay updated!":"Stay updated!","Click and never miss future streams!":"Click and never miss future streams!","This stream is offline":"This stream is offline.","the next time goes live":"the next time goes live","Follow":"Follow","on the Fediverse to see the next time goes live":"on the Fediverse to see the next time goes live","Last live ago":"Last live ago","Time":"Time","User":"User","Visible messages":"Visible messages","Hidden messages":"Hidden messages","Chat Messages":"Chat Messages","Manage the messages from viewers that show up on your stream":"Manage the messages from viewers that show up on your stream.","Show":"Show","Hide":"Hide","Visit the":"Visit the","documentation":"documentation","to configure additional details about your viewers":"to configure additional details about your viewers.","When a stream is active and chat is enabled, connected chat clients will be displayed here":"When a stream is active and chat is enabled, connected chat clients will be displayed here.","Connected":"Connected","offline":"offline","Banned Users":"Banned Users","IP Bans":"IP Bans","Moderators":"Moderators","Hardware Info":"Hardware Info","Please wait":"Please wait","No hardware details have been collected yet":"No hardware details have been collected yet.","CPU":"CPU","Memory":"Memory","Disk":"Disk","used":"used","I want to configure my owncast instance":"I want to configure my owncast instance","Learn more":"Learn more","Help configuring my broadcasting software":"Help configuring my broadcasting software","I want to embed my stream into another site":"I want to embed my stream into another site","I want to customize my website":"I want to customize my website","I want to tweak my video output":"I want to tweak my video output","I want to use an external storage provider":"I want to use an external storage provider","I found a bug":"I found a bug","If you found a bug, then please":"If you found a bug, then please","let us know":"let us know","I have a general question":"I have a general question","Most general questions are answered in our":"Most general questions are answered in our","FAQ":"FAQ","or exist in our":"or exist in our","discussions":"discussions","I want to build add-ons for Owncast":"I want to build add-ons for Owncast","You can build your own bots, overlays, tools and add-ons with our":"You can build your own bots, overlays, tools and add-ons with our","developer APIs":"developer APIs.","How can we help you?":"How can we help you?","Troubleshooting":"Troubleshooting","Fix your problems":"Fix your problems","Read the Docs":"Read the Docs","Common tasks":"Common tasks","Other":"Other","Outbound Video Stream":"Outbound Video Stream","Outbound Audio Stream":"Outbound Audio Stream","Stream started":"Stream started","Viewers":"Viewers","Peak viewer count":"Peak viewer count","Outbound Stream Details":"Outbound Stream Details","Inbound Stream Details":"Inbound Stream Details","Input":"Input","Inbound Video Stream":"Inbound Video Stream","Inbound Audio Stream":"Inbound Audio Stream","Current stream":"Current stream","Last 12 hours":"Last 12 hours","Last 24 hours":"Last 24 hours","Last 7 days":"Last 7 days","Last 30 days":"Last 30 days","Last 3 months":"Last 3 months","Last 6 months":"Last 6 months","Viewer Info":"Viewer Info","Current viewers":"Current viewers","Max viewers this stream":"Max viewers this stream","Max viewers last stream":"Max viewers last stream","max viewers":"max viewers","No viewer data has been collected yet":"No viewer data has been collected yet."}')}},function(e){e.O(0,[2196,83,1287,3800,7786,443,9904,3657,6167,2502,7528,9532,449,7043,4065,9307,2642,7039,1913,6179,297,346,5889,2888,9774,179],function(){return e(e.s=92794)}),_N_E=e.O()}]);